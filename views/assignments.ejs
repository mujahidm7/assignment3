<%- include('partials/header') %>

<div class="container mt-4">
  <h1><%= title %></h1>

  <% if (currentUser) { %>
    <p>Logged in as: <strong><%= currentUser.name %></strong></p>
    <form action="/logout" method="POST">
      <button class="btn btn-danger btn-sm">Logout</button>
    </form>
    <a href="/assignments/new" class="btn btn-primary mt-3">Add New Assignment</a>
  <% } else { %>
    <p>You are viewing as a guest (read-only).</p>
    <a href="/login" class="btn btn-success">Login to manage assignments</a>
  <% } %>

  <table class="table table-striped mt-4">
    <thead>
      <tr>
        <th>Title</th>
        <th>Course</th>
        <th>Due Date</th>
        <th>Status</th>
        <% if (currentUser) { %>
          <th>Actions</th>
        <% } %>
      </tr>
    </thead>

    <tbody>
      <% assignments.forEach(assignment => { %>
        <tr>
          <td><%= assignment.title %></td>
          <td><%= assignment.course %></td>
          <td><%= assignment.dueDate ? assignment.dueDate.toISOString().slice(0, 10) : '' %></td>
          <td><%= assignment.status %></td>

          <% if (currentUser) { %>
            <td>
              <a href="/assignments/<%= assignment._id %>/edit" class="btn btn-warning btn-sm">Edit</a>
              <a href="/assignments/<%= assignment._id %>/delete" class="btn btn-danger btn-sm">Delete</a>
            </td>
          <% } %>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<%- include('partials/footer') %>
